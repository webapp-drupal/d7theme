/**
 * @license ev-em.min.js v3.2.10
 * (c) 2015-2017 Evolok, Inc. http://www.evolok.com/
 *
 * License: MIT
 */
window.EV=window.EV||{},function(o){"use strict";function t(){var e="Unknown";return navigator.userAgent.indexOf("MSIE")!=-1?e="MSIE":navigator.userAgent.indexOf("Firefox")!=-1?e="Firefox":navigator.userAgent.indexOf("Opera")!=-1?e="Opera":navigator.userAgent.indexOf("Chrome")!=-1?e="Chrome":navigator.userAgent.indexOf("Safari")!=-1&&(e="Safari"),e}function n(){void 0===v&&void 0===p||""===v&&""===p||(void 0!==v&&""!==v&&r("ev_sid")!=v&&(i("ev_sid",v,10),c("ev_sid",v,0,"localStorage"),m=m+"&ev_sid="+v),void 0!==p&&""!==p&&r("ev_did")!=p&&(i("ev_did",p,10),c("ev_did",p,0,"localStorage"),m=m+"&ev_did="+p))}function r(e){var o,t="; "+document.cookie,n=t.split("; "+e+"=");return 2==n.length?(o=n.pop().split(";").shift(),o=o.replace(/["'()]/g,"")):""}function i(e,o,t){if(!f.sidCookieDomain)throw new Error("Please specify sidCookieDomain in the config!",!0);var n=new Date;t=1460,n.setDate(n.getDate()+t),document.cookie=e+"="+escape(o)+(null===t?"":";expires="+n.toUTCString())+";path=/; domain="+f.sidCookieDomain,console.log(e+"="+escape(o)+(null===t?"":";expires="+n.toUTCString())+";path=/; domain="+f.sidCookieDomain)}function a(e){return""!==r(e)&&"undefined"!==r(e)?r(e):void 0}function s(e){return""!==l(e,"localStorage")&&"undefined"!==l(e,"localStorage")?l(e,"localStorage"):void 0}function d(){if(!f)throw"Evolok Metering library is not initialised!"}function l(e,o){var t=document.cookie.indexOf(e+"=");return"localStorage"==o?"undefined"!=typeof localStorage?localStorage.getItem(e):document.cookie.length>0&&t!==-1?getCookieSubstring(t,e):"":"sessionStorage"==o?"undefined"!=typeof sessionStorage?(console.log(sessionStorage.getItem(e)),sessionStorage.getItem(e)):(t=document.cookie.indexOf(e+"="),document.cookie.length>0&&t!==-1?getCookieSubstring(t,e):""):void 0}function c(e,o,t,n){var r=new Date;"localStorage"==n&&(r.setDate(r.getDate()+t),"undefined"!=typeof localStorage?localStorage.setItem(e,o):document.cookie=e+"="+escape(o)+(null===t?"":";expires="+r.toUTCString())),"sessionStorage"==n&&(r.setDate(r.getDate()+t),"undefined"!=typeof sessionStorage?sessionStorage.setItem(e,o):document.cookie=e+"="+escape(o)+(null===t?"":";expires="+r.toUTCString()))}function u(e){var o="";e=JSON.parse(e);for(var t in e)""!==o&&(o+="&"),o+=t+"="+encodeURIComponent(e[t]);return o}function g(e,o){d();var t=f.url;if(!t)throw new Error("Evolok Metering host url is not configured!");return t+="/"===t.charAt(t.length-1)&&"/"===e.charAt(0)?e.substring(1,e.length):e,t=o?t+"?"+o:t}var f,v,p,m,S;o.Em={init:function(e){if(!e.hasOwnProperty("url"))throw"Configuration must specify the url property!";f=e},authorize:function(e,t,n){o.Em.assert(e,"Parameters should not be empty!"),o.Em.assert(t,"Success callback should not be empty!"),o.Em.assert(n,"Error callback should not be empty!");var d=u(e),w="",h="",_="";m=d,a("ev_sid")?(h="&ev_sid="+r("ev_sid"),c("ev_sid",r("ev_sid"),0,"localStorage")):s("ev_sid")&&(f.hasOwnProperty("meterHD")?f.meterHD===!0&&(i("ev_sid",l("ev_sid","localStorage"),10),h="&ev_sid="+l("ev_sid","localStorage"),S=f.meterHD):i("ev_sid",l("ev_sid","localStorage"),10)),a("ev_did")?(_="&ev_did="+r("ev_did"),c("ev_did",r("ev_did"),0,"localStorage")):s("ev_did")&&(f.hasOwnProperty("meterHD")?f.meterHD===!0&&(i("ev_did",l("ev_did","localStorage"),10),_="&ev_did="+l("ev_did","localStorage")):i("ev_did",l("ev_did","localStorage"),10)),""!==r("ev_ss")&&(w+="&ev_ss="+r("ev_ss")),d=d+w+h+_;var y=g("/authorize/json",d),E=new XMLHttpRequest;E.open("GET",y,!0),E.withCredentials=!0,E.onload=function(){function e(e){var o;"function"==typeof CustomEvent?o=new CustomEvent("ev.ad.authorize",{detail:e}):(o=document.createEvent("CustomEvent"),o.initCustomEvent("ev.ad.authorize",!1,!1,e)),window.dispatchEvent(o)}if(E.status>=200&&E.status<400){var o=JSON.parse(E.responseText);e(o),window.addEventListener("ev.widgets.paywall.load",function(){e(o)}),window.addEventListener("ev.widgets.notifier.load",function(){e(o)}),o.hasOwnProperty("sessionKeys")&&o.sessionKeys.hasOwnProperty("ev_sid")&&(v=o.sessionKeys.ev_sid),o.hasOwnProperty("sessionKeys")&&o.sessionKeys.hasOwnProperty("ev_did")&&(p=o.sessionKeys.ev_did),t(o)}else n&&n(E.status,E.responseText)},E.onerror=function(e){e?n(e):n(0,"unknown connection error")},E.send()},pretty_print:function(e){var t=/^( *)("[\w]+": )?("[^"]*"|[\w.+-]*)?([,[{])?$/gm,n=JSON.stringify(e,null,3).replace(/&/g,"&amp;").replace(/\\"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(t,o.Em.replacer);return n="<pre>"+n+"</pre>"},replacer:function(e,o,t,n,r){var i="<span class=json-key>",a="<span class=json-value>",s="<span class=json-string>",d=o||"";return t&&(d=d+i+t.replace(/[": ]/g,"")+"</span>: "),n&&(d=d+('"'==n[0]?s:a)+n+"</span>"),d+(r||"")},get_cookie_local_storage:function(e){if("undefined"!=typeof localStorage)return localStorage.getItem(e);var o=document.cookie.indexOf(e+"=");return document.cookie.length>0&&o!==-1?getCookieSubstring(o,e):""},set_cookie_local_storage:function(e,o,t){var n=new Date;n.setDate(n.getDate()+t),"undefined"!=typeof localStorage?(alert("This place has local storage!"),localStorage.setItem(e,o)):document.cookie=e+"="+escape(o)+(null===t?"":";expires="+n.toUTCString())},segment:function(t,n,r){o.Em.assert(t,"Parameters should not be empty!"),o.Em.assert(n,"Success callback should not be empty!"),o.Em.assert(r,"Error callback should not be empty!");var i=u(t),a=g("/segment",i),s=new XMLHttpRequest;s.open("GET",a,!0),s.withCredentials=!0,s.onload=function(){if(s.status>=200&&s.status<400){var e=JSON.parse(s.responseText);n(e)}else r&&r(s.status,s.responseText)},s.onerror=function(){e?r(e):r(0,"unknown connection error")},s.send()},call_VerifyCookiesforSafari:function(){n()},get_Browser_Name:function(){var e="Unknown";return navigator.userAgent.indexOf("MSIE")!=-1?e="MSIE":navigator.userAgent.indexOf("Firefox")!=-1?e="Firefox":navigator.userAgent.indexOf("Opera")!=-1?e="Opera":navigator.userAgent.indexOf("Chrome")!=-1?e="Chrome":navigator.userAgent.indexOf("Safari")!=-1&&(e="Safari"),e},assert:function(e,o){if(!e){if(o=o||"Assertion failed","undefined"!=typeof Error)throw new Error(o);throw o}},getUrl:function(){return f.url}},"Safari"==t()?setTimeout(function(){n()},4e3):setTimeout(function(){n()},4e3)}(window.EV),function(){if(!window.EV.Em)throw new Error("Couldn't find the Evolok Metering library in the browser context!")}();